<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Set new password — Market Llama</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description"
        content="Set a new password for your Market Llama account after confirming your reset code." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
  <link rel="icon" type="image/svg+xml"
        href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="30" fill="%231a6d72"/><path d="M20 34h24v6H20zM20 24h18v6H20z" fill="white"/></svg>' />
  <style>
    :root {
      --nav-height: 64px;
      --nav-teal: #1a6d72;

      --bg: #000000;
      --card-bg: rgba(8, 12, 20, 0.9);
      --card-border: rgba(255, 255, 255, 0.14);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --primary: #1a6d72;
      --primary-hover: #20848a;
      --primary-soft: rgba(26, 109, 114, 0.25);
      --error: #f97373;
      --input-bg: rgba(15, 23, 42, 0.95);
      --input-border: rgba(148, 163, 184, 0.6);
      --shadow-card: 0 30px 80px rgba(0, 0, 0, 0.8);
      --radius-card: 24px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: --bg;
      background: var(--bg);
      color: var(--text);
    }

    /* ===========================
       FIXED TOP NAV
       =========================== */
    .auth-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--nav-height);
      padding: 0 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(26, 109, 114, 0.98);
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: 100;
    }

    .auth-header-left {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: #ffffff;
    }

    .auth-logo {
      width: 30px;
      height: 30px;
      object-fit: contain;
    }

    .auth-brand {
      font-weight: 700;
      font-size: 1.05rem;
    }

    .auth-header-right {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 0.88rem;
    }

    .auth-header-right span {
      color: #e5f4f6;
    }

    .auth-header-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1.4rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      background: rgba(255, 255, 255, 0.08);
      color: #ffffff;
      font-size: 0.9rem;
      text-decoration: none;
      transition: background 0.18s ease, transform 0.18s ease, box-shadow 0.18s ease;
    }

    .auth-header-link:hover {
      background: rgba(255, 255, 255, 0.16);
      transform: translateY(-1px);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
    }

    /* ===========================
       SHELL / LAYOUT
       =========================== */
    .shell {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding-top: var(--nav-height);
    }

    .shell-main {
      flex: 1;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 84px 16px 40px;
      background:
        radial-gradient(circle at 10% 0%, rgba(56, 189, 248, 0.08), transparent 60%),
        radial-gradient(circle at 90% 100%, rgba(34, 197, 94, 0.06), transparent 55%),
        #000000;
    }

    /* ===========================
       CARD – GLASS, WIDE & LONG
       =========================== */
    .card {
      width: 100%;
      max-width: 720px;
      min-height: 780px;
      background: var(--card-bg);
      border-radius: var(--radius-card);
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-card);
      padding: 44px 48px 36px;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -20% -40% auto auto;
      background: radial-gradient(circle at top, rgba(26, 109, 114, 0.32), transparent 65%);
      opacity: 0.8;
      pointer-events: none;
    }

    .card > * {
      position: relative;
      z-index: 1;
    }

    .card-title {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 6px;
      color: #f9fafb;
    }

    .card-subtitle {
      font-size: 0.94rem;
      color: var(--muted);
      max-width: 460px;
      line-height: 1.6;
      margin-bottom: 26px;
    }

    /* ===========================
       FORM
       =========================== */
    .form-row {
      margin-bottom: 18px;
    }

    .form-label {
      display: block;
      font-size: 0.86rem;
      margin-bottom: 6px;
      color: #e5e7eb;
      font-weight: 500;
    }

    .form-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text);
      font-size: 0.92rem;
      outline: none;
      transition: border-color 0.18s ease, box-shadow 0.18s ease, background 0.18s ease,
                  transform 0.1s ease;
    }

    .form-input::placeholder {
      color: rgba(148, 163, 184, 0.7);
    }

    .form-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 1px var(--primary-soft);
      background: #050709;
      transform: translateY(-1px);
    }

    .form-helper {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .form-error {
      font-size: 0.8rem;
      color: var(--error);
      margin-top: 8px;
      min-height: 1.1em;
    }

    /* ===========================
       PASSWORD WITH EYE ICON
       =========================== */
    .pw-field {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      border-radius: 10px;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      padding-right: 0.35rem;
      transition: border-color 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }

    .pw-field:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 1px var(--primary-soft);
      background: #050709;
    }

    .pw-field input {
      flex: 1;
      border: none;
      background: transparent;
      padding: 10px 12px;
      font-size: 0.92rem;
      color: #f9fafb;
      outline: none;
    }

    .pw-toggle {
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0 0.4rem;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.85;
      transition: opacity 0.15s ease, transform 0.1s ease;
    }

    .pw-toggle:hover {
      opacity: 1;
      transform: translateY(-0.5px);
    }

    .pw-toggle svg {
      width: 18px;
      height: 18px;
      fill: #e5e7eb;
    }

    /* ===========================
       BUTTON
       =========================== */
    .card-actions {
      margin-top: 24px;
      margin-bottom: 8px;
    }

    .btn-primary {
      width: 100%;
      border-radius: 999px;
      padding: 11px 16px;
      border: none;
      font-size: 0.96rem;
      font-weight: 600;
      cursor: pointer;
      background: var(--primary);
      color: #e5f9f9;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 22px 52px rgba(0, 0, 0, 0.7);
      background: var(--primary-hover);
    }

    .btn-primary:disabled {
      opacity: 0.7;
      cursor: default;
      transform: none;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
    }

    .card-footer {
      margin-top: 16px;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .card-footer a {
      color: #60a5fa;
      text-decoration: none;
      font-weight: 500;
    }

    .card-footer a:hover {
      text-decoration: underline;
    }

    /* ===========================
       FOOTER + DISCLAIMER
       =========================== */
    .page-footer {
      padding: 32px 16px 24px;
      background: rgba(255, 255, 255, 0.04);
      border-top: 1px solid rgba(255, 255, 255, 0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: #d1d5db;
      margin-top: 16px;
    }

    .footer-inner {
      max-width: 1200px;
      margin: 0 auto;
    }

    .footer-disclaimer-wrap {
      max-width: 1200px;
      margin: 0 auto 2rem auto;
    }

    .risk-disclaimer {
      font-size: 0.9rem;
      line-height: 1.55;
      color: #bfbfbf;
      text-align: left;
    }

    .risk-disclaimer strong {
      color: #e0e0e0;
      display: block;
      margin-bottom: 0.75rem;
    }

    .footer-columns {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1.2rem;
      margin-top: 1.5rem;
      margin-bottom: 1.2rem;
    }

    .footer-col h4 {
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #ffffff;
      font-size: 0.95rem;
    }

    .footer-col a {
      display: block;
      font-size: 0.85rem;
      margin: 3px 0;
      color: #d1d5db;
      text-decoration: none;
      opacity: 0.9;
      transition: opacity 0.18s ease, transform 0.12s ease;
    }

    .footer-col a:hover {
      opacity: 1;
      transform: translateY(-1px);
    }

    .footer-note {
      font-size: 0.78rem;
      color: #9ca3af;
      text-align: center;
      margin-top: 6px;
    }

    /* ===========================
       CHAT WIDGET – DARK TURQUOISE
       =========================== */
    .chat-fab {
      position: fixed;
      right: 20px;
      bottom: 88px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--nav-teal);
      color: #eaeaea;
      border: 1px solid rgba(255, 255, 255, .18);
      cursor: pointer;
      z-index: 1100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 24px rgba(0, 0, 0, .45);
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
      backdrop-filter: blur(8px);
    }

    .chat-fab:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(0, 0, 0, .5);
      background: #20848a;
    }

    .chat-fab svg {
      width: 24px;
      height: 24px;
      stroke: currentColor;
    }

    .chat-panel {
      position: fixed;
      right: 20px;
      bottom: 156px;
      width: min(420px, 92vw);
      max-height: 72vh;
      background: rgba(8, 20, 24, .96);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(26, 109, 114, 0.6);
      border-radius: 16px;
      z-index: 1200;
      display: flex;
      flex-direction: column;
      opacity: 0;
      transform: translateY(8px) scale(.98);
      pointer-events: none;
      transition: opacity .2s ease, transform .2s ease;
      color: #fff;
      overflow: hidden;
    }

    .chat-panel.open {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: auto;
    }

    .chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255, 255, 255, .06);
      background: var(--nav-teal);
    }

    .chat-title {
      font-weight: 600;
    }

    .chat-close {
      background: none;
      border: none;
      color: #fff;
      font-size: 22px;
      cursor: pointer;
      line-height: 1;
    }

    .chat-body {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: auto;
    }

    .chat-msg {
      font-size: .92rem;
      line-height: 1.4;
      background: rgba(255, 255, 255, .06);
      color: #eaeaea;
      padding: 8px 10px;
      border-radius: 12px;
      max-width: 85%;
    }

    .chat-msg.bot {
      align-self: flex-start;
    }

    .chat-msg.user {
      align-self: flex-end;
      background: var(--nav-teal);
      color: #fff;
    }

    .chat-input-row {
      display: flex;
      gap: 8px;
      padding: 12px;
      border-top: 1px solid rgba(255, 255, 255, .06);
      background: rgba(6, 14, 16, 0.96);
    }

    .chat-input-row input {
      flex: 1;
      background: rgba(255, 255, 255, .06);
      border: 1px solid rgba(255, 255, 255, .12);
      color: #fff;
      border-radius: 12px;
      padding: 10px 12px;
    }

    .chat-send {
      background: var(--nav-teal);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 14px;
      cursor: pointer;
    }

    /* ===========================
       RESPONSIVE
       =========================== */
    @media (max-width: 720px) {
      .auth-header {
        padding: 0 16px;
      }

      .auth-header-right span {
        display: none;
      }

      .shell-main {
        padding: 84px 12px 32px;
      }

      .card {
        padding: 30px 20px 26px;
        min-height: 680px;
        border-radius: 18px;
      }

      .card-title {
        font-size: 1.6rem;
      }

      .chat-fab {
        right: 14px;
      }

      .chat-panel {
        right: 14px;
      }
    }
  </style>
</head>

<body>
  <!-- Fixed nav bar -->
  <header class="auth-header">
    <a href="index.html#hero" class="auth-header-left">
      <img src="assets/llama.webp" alt="Market Llama logo" class="auth-logo" />
      <span class="auth-brand">Market Llama</span>
    </a>
    <div class="auth-header-right">
      <span>Remembered your password?</span>
      <a href="signin.html" class="auth-header-link">Sign in</a>
    </div>
  </header>

  <div class="shell">
    <main class="shell-main">
      <section class="card" aria-labelledby="setNewPasswordTitle">
        <h1 id="setNewPasswordTitle" class="card-title">Set a new password</h1>
        <p class="card-subtitle">
          Choose a new password for your Market Llama account. Your reset code has already been confirmed.
        </p>

        <form id="setNewPasswordForm" novalidate>
          <div class="form-row">
            <label for="password" class="form-label">New password</label>
            <div class="pw-field">
              <input
                id="password"
                name="password"
                type="password"
                placeholder="Enter a new password"
                autocomplete="new-password"
                required
              />
              <button type="button" class="pw-toggle" data-target="password" aria-label="Toggle password visibility">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 5C7 5 3.1 8.1 1.5 12c1.6 3.9 5.5 7 10.5 7s8.9-3.1 10.5-7C20.9 8.1 17 5 12 5zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-2.2A1.8 1.8 0 1 0 12 9a1.8 1.8 0 0 0 0 3.8z" />
                </svg>
              </button>
            </div>
            <div class="form-helper">
              Use at least 8 characters, including letters and numbers.
            </div>
          </div>

          <div class="form-row">
            <label for="confirmPassword" class="form-label">Confirm new password</label>
            <div class="pw-field">
              <input
                id="confirmPassword"
                name="confirmPassword"
                type="password"
                placeholder="Re-enter your new password"
                autocomplete="new-password"
                required
              />
              <button type="button" class="pw-toggle" data-target="confirmPassword" aria-label="Toggle password visibility">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 5C7 5 3.1 8.1 1.5 12c1.6 3.9 5.5 7 10.5 7s8.9-3.1 10.5-7C20.9 8.1 17 5 12 5zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-2.2A1.8 1.8 0 1 0 12 9a1.8 1.8 0 0 0 0 3.8z" />
                </svg>
              </button>
            </div>
          </div>

          <div id="formError" class="form-error"></div>

          <div class="card-actions">
            <button id="setPwdBtn" type="submit" class="btn-primary">
              Save new password
            </button>
          </div>
        </form>

        <div class="card-footer">
          Remembered your password?
          <a href="signin.html">Sign in</a>
        </div>
      </section>
    </main>

    <!-- Shared footer + disclaimer -->
    <footer class="page-footer">
      <div class="footer-inner">
        <div class="footer-disclaimer-wrap">
          <div class="risk-disclaimer">
            <strong>⚠️ Risk Disclaimer:</strong>
            Trading in financial markets carries inherent risks, including the potential for loss of capital.
            Performance may vary based on market conditions, account size, risk tolerance, and execution environment.
            While Market Llama is built to deliver consistent, data-driven performance through advanced automation and
            professional account management, no trading environment is completely without risk.
            <br /><br />
            Users should understand that smaller accounts face higher exposure to volatility, faster drawdown cycles,
            and reduced margin flexibility compared to larger accounts. Larger accounts can withstand market
            fluctuations more effectively, but they are still subject to market risk and temporary performance
            deviations.
            <br /><br />
            Market Llama operates as a technology-enabled, professional account management platform — similar to
            institutional asset managers — providing users with sophisticated trading systems, automated execution, and
            real-time risk controls. Our purpose is to optimize performance, protect user capital, and deliver
            institutional-grade trading outcomes.
            <br /><br />
            By connecting your trading account to Market Llama, you acknowledge that every investment activity carries
            risk, and that results can vary across market conditions. We commit to operating transparently, managing
            accounts responsibly, and applying disciplined, data-driven strategies designed to achieve consistent
            long-term performance.
          </div>
        </div>

        <div class="footer-columns">
          <div class="footer-col">
            <h4>Company</h4>
            <a href="abouts.html">About</a>
          </div>
          <div class="footer-col">
            <h4>Resources</h4>
            <a href="support.html">Support</a>
          </div>
          <div class="footer-col">
            <h4>Legal</h4>
            <a href="terms.html">Terms</a>
            <a href="privacy.html">Privacy</a>
          </div>
          <div class="footer-col">
            <h4>Connect</h4>
            <a href="#">Whatsapp</a>
            <a href="#">Twitter</a>
            <a href="#">Facebook</a>
            <a href="#">Instagram</a>
          </div>
        </div>

        <p class="footer-note">© 2025 Market Llama. All rights reserved.</p>
      </div>
    </footer>
  </div>

  <!-- CHAT -->
  <button id="chatFab" class="chat-fab" aria-label="Open chat" aria-controls="chatPanel">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"
      stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M20 3H4a2 2 0 0 0-2 2v12l4-4h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z" />
      <circle cx="9" cy="10" r="1.25" />
      <circle cx="12" cy="10" r="1.25" />
      <circle cx="15" cy="10" r="1.25" />
    </svg>
  </button>
  <div id="chatPanel" class="chat-panel" role="dialog" aria-label="Assistant chat" aria-modal="true"
    aria-hidden="true">
    <div class="chat-header">
      <div class="chat-title">Assistant</div>
      <button id="chatClose" class="chat-close" aria-label="Close chat">×</button>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-msg bot">Hi! How can I help?</div>
    </div>
    <form id="chatForm" class="chat-input-row">
      <input id="chatInput" type="text" placeholder="Type a message…" autocomplete="off" />
      <button class="chat-send" type="submit">Send</button>
    </form>
  </div>

  <!-- CONFIG (ML_CONFIG) -->
  <script src="scripts/config.js"></script>

  <!-- PAGE LOGIC + CHAT -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("setNewPasswordForm");
      const pwdInput = document.getElementById("password");
      const confirmInput = document.getElementById("confirmPassword");
      const errorBox = document.getElementById("formError");
      const btn = document.getElementById("setPwdBtn");

      // Pull email + code from localStorage (set in previous steps)
      const email = window.localStorage.getItem("resetEmail");
      const code = window.localStorage.getItem("resetCode");

      function setError(msg) {
        if (!errorBox) return;
        errorBox.textContent = msg || "";
      }

      // If user lands here without email/code, force restart flow
      if (!email || !code) {
        setError("Your reset session has expired. Please start again.");
      }

      // Password eye toggles
      document.querySelectorAll(".pw-toggle").forEach(btnToggle => {
        btnToggle.addEventListener("click", () => {
          const targetId = btnToggle.getAttribute("data-target");
          const input = document.getElementById(targetId);
          if (!input) return;
          const isPwd = input.type === "password";
          input.type = isPwd ? "text" : "password";
        });
      });

      if (form) {
        form.addEventListener("submit", async function (e) {
          e.preventDefault();
          setError("");

          const pwd = (pwdInput.value || "").trim();
          const confirmPwd = (confirmInput.value || "").trim();

          if (!email || !code) {
            setError("Reset session expired. Please go back and request a new reset code.");
            return;
          }

          if (!pwd) {
            setError("Please enter a new password.");
            pwdInput.focus();
            return;
          }

          if (pwd.length < 8) {
            setError("Password must be at least 8 characters long.");
            pwdInput.focus();
            return;
          }

          if (!confirmPwd) {
            setError("Please confirm your new password.");
            confirmInput.focus();
            return;
          }

          if (pwd !== confirmPwd) {
            setError("Passwords do not match. Please try again.");
            confirmInput.focus();
            return;
          }

          const originalText = btn.textContent;
          btn.disabled = true;
          btn.textContent = "Saving…";

          try {
            const baseUrl = window.ML_CONFIG?.API_BASE_URL || "http://72.61.201.223:8000";

            const resp = await fetch(baseUrl + "/api/auth/reset-password", {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify({
                email: email,
                code: code,
                new_password: pwd
              })
            });

            const data = await resp.json().catch(() => ({}));

            if (!resp.ok) {
              const detail = data.detail || "Failed to update password. Please try again.";
              setError(detail);
              btn.disabled = false;
              btn.textContent = originalText;
              return;
            }

            // Success
            window.localStorage.removeItem("resetEmail");
            window.localStorage.removeItem("resetCode");

            alert("Password updated successfully. You can now sign in.");

            const signinUrl = window.ML_CONFIG?.SIGNIN_URL || "signin.html";
            window.location.href = signinUrl;
          } catch (err) {
            console.error(err);
            setError("Something went wrong. Please check your connection and try again.");
            btn.disabled = false;
            btn.textContent = originalText;
          }
        });
      }

      // Chat wiring
      const chatFab = document.getElementById('chatFab');
      const chatPanel = document.getElementById('chatPanel');
      const chatClose = document.getElementById('chatClose');
      const chatForm = document.getElementById('chatForm');
      const chatInput = document.getElementById('chatInput');
      const chatBody = document.getElementById('chatBody');

      function openChat() {
        chatPanel.classList.add('open');
      }

      function closeChat() {
        chatPanel.classList.remove('open');
      }

      if (chatFab) {
        chatFab.addEventListener('click', function (e) {
          e.stopPropagation();
          openChat();
        });
      }

      if (chatClose) {
        chatClose.addEventListener('click', function (e) {
          e.stopPropagation();
          closeChat();
        });
      }

      document.addEventListener('click', function (e) {
        if (!chatPanel.classList.contains('open')) return;

        const target = e.target;
        if (chatPanel.contains(target) || chatFab.contains(target)) return;

        e.preventDefault();
        e.stopPropagation();
        closeChat();
      }, true);

      if (chatForm) {
        chatForm.addEventListener('submit', function (e) {
          e.preventDefault();
          const text = chatInput.value.trim();
          if (!text) return;
          const msg = document.createElement('div');
          msg.className = 'chat-msg user';
          msg.textContent = text;
          chatBody.appendChild(msg);
          chatInput.value = '';
          chatBody.scrollTop = chatBody.scrollHeight;
        });
      }
    });
  </script>
</body>
</html>