<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Accounts — Market Llama</title>
  <meta name="description" content="Manage your live and demo trading accounts." />

  <!-- Iconify -->
  <script src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml"
        href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="30" fill="%234169E1"/><path d="M20 34h24v6H20zM20 24h18v6H20z" fill="white"/></svg>' />
  
  <!-- LOAD NAVBAR CSS -->
  <link rel="stylesheet" href="components/navbar.css">
  
  <!-- PAGE-SPECIFIC STYLES -->
  <style>
    :root {
      --header-h: 60px;
      --bg: #0b0b0c;
      --panel: #121214;
      --muted: #8f8f92;
      --text: #ffffff;
      --accent: #ffffff;
      --accent-plain: #dadada;
      --glow: rgba(255, 255, 255, .06);
      --glass: rgba(255, 255, 255, .04);
      --ring: rgba(255, 255, 255, .12);
      --pill: #16171a;
      --shadow: 0 8px 24px rgba(0, 0, 0, .45);
      --nav-teal: #1a6d72;
      --header-blue: #0097b2;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { font-size: 14px; }
    body.app.dark {
      background: var(--bg);
      color: var(--text);
      font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow-x: hidden;
    }

    /* ===== PROFILE BACKGROUND ===== */
    .profile-background {
      position: fixed;
      inset: 0;
      z-index: -1;
      width: 150vw;
      height: 120vh;
      top: -10%;
      left: 15%;
      background:
        radial-gradient(200px 260px at 20% 30%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(180px 240px at 40% 20%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(140px 200px at 25% 70%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(100px 140px at 75% 25%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(160px 220px at 80% 60%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(120px 180px at 60% 80%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%);
      filter: blur(60px);
      opacity: 0.6;
      pointer-events: none;
    }

    /* ===== LAYOUT ===== */
    .dashboard { min-height: 100vh; padding-top: var(--header-h); }

    .content {
      margin-left: 240px;
      padding: 18px clamp(12px, 2vw, 24px);
      transition: margin-left 0.25s ease;
    }
    .side[data-state="collapsed"] ~ .content { margin-left: 68px; }

    .content-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 8px 0 16px;
    }

    .page-title {
      font-size: clamp(22px, 3vw, 42px);
      font-weight: 800;
      letter-spacing: .3px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border-radius: 12px;
      border: 1px solid var(--ring);
      background: var(--glass);
      color: var(--text);
      cursor: pointer;
      box-shadow: var(--shadow);
      font-size: .95rem;
      transition: all 0.2s ease;
      text-decoration: none;
      white-space: nowrap;
    }
    .btn:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-1px); }

    /* ===== ACCOUNTS UI ===== */
    .greeting { color: rgba(255,255,255,.9); margin: 6px 0 16px; }

    .tabs {
      display: flex;
      gap: 8px;
      margin: 8px 0 14px;
    }
    .tab {
      background: #1a1b1f;
      border: 1px solid var(--ring);
      color: var(--accent-plain);
      padding: 8px 16px;
      border-radius: 999px;
      cursor: pointer;
      font-size: .95rem;
      font-family: inherit;
      transition: transform .15s ease, background .15s ease;
    }
    .tab:hover { transform: translateY(-1px); background: rgba(255,255,255,.07); }
    .tab.active {
      background: var(--text);
      color: #000;
    }

    .chip {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 999px;
      background: #1a1b1f;
      border: 1px solid var(--ring);
      font-size: .8rem;
      margin-right: 8px;
      color: #fff;
    }
    .chip-live { background: #4CAF50; color: #fff; border-color: rgba(255,255,255,.14); }
    .chip-demo { background: #FF9800; color: #fff; border-color: rgba(255,255,255,.14); }
    .chip-broker { background: #2196F3; color: #fff; border-color: rgba(255,255,255,.14); }

    .account-card {
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255, 255, 255, .04), rgba(255, 255, 255, .02));
      border: 1px solid var(--ring);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 14px;
      margin-bottom: 10px;
      width: min(1400px, 100%);
      transition: width 0.25s ease;
    }

    .side[data-state="collapsed"] ~ .content .account-card {
      width: min(1700px, 100%);
    }

    .card-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .card-body {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 6px 16px;
    }

    .big-amount {
      font-size: 16px;
      font-weight: 500;
      letter-spacing: 1.4px;
      color: #fff;
    }

    .card-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .line-art {
      position: absolute;
      inset: -10% -5% auto auto;
      height: 120%;
      width: 70%;
      pointer-events: none;
      opacity: .18;
      filter: blur(.2px);
      background:
        radial-gradient(100px 120px at 40% 35%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(120px 160px at 55% 48%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(160px 220px at 65% 60%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%);
    }

    /* ===== FOOTER ===== */
    .legal-footer {
      margin-left: 240px;
      margin-top: 24px;
      padding: 18px clamp(12px, 2vw, 24px);
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--muted);
      font-size: 13px;
      transition: margin-left 0.25s ease;
    }
    .side[data-state="collapsed"] ~ .legal-footer { margin-left: 68px; }

    .footer-inner {
      max-width: none;
      margin: 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 24px;
    }
    .footer-risk { line-height: 1.7; max-width: 720px; }
    .footer-links { text-align: right; font-size: 13px; }
    .footer-links-list { list-style: none; display: flex; flex-direction: column; gap: 4px; }
    .footer-links a {
      color: var(--accent-plain);
      text-decoration: none;
      opacity: 0.9;
      transition: opacity 0.2s ease, text-decoration-color 0.2s ease;
    }
    .footer-links a:hover { opacity: 1; text-decoration: underline; }

    /* ===== CHAT ===== */
    .chat-fab {
      position: fixed;
      right: 20px;
      bottom: 88px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--nav-teal);
      color: #eaeaea;
      border: 1px solid rgba(255, 255, 255, .18);
      cursor: pointer;
      z-index: 1100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 24px rgba(0, 0, 0, .45);
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
      backdrop-filter: blur(8px);
    }
    .chat-fab:hover { transform: translateY(-1px); box-shadow: 0 14px 30px rgba(0, 0, 0, .5); background: #20848a; }
    .chat-fab svg { width: 24px; height: 24px; stroke: currentColor; }

    .chat-panel {
      position: fixed;
      right: 20px;
      bottom: 156px;
      width: min(420px, 92vw);
      max-height: 72vh;
      background: rgba(8, 20, 24, .96);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(26, 109, 114, 0.6);
      border-radius: 16px;
      z-index: 1200;
      display: flex;
      flex-direction: column;
      opacity: 0;
      transform: translateY(8px) scale(.98);
      pointer-events: none;
      transition: opacity .2s ease, transform .2s ease;
      color: #fff;
      overflow: hidden;
    }
    .chat-panel.open { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }

    .chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255, 255, 255, .06);
      background: var(--nav-teal);
    }
    .chat-title { font-weight: 600; }
    .chat-close { background: none; border: none; color: #fff; font-size: 22px; cursor: pointer; line-height: 1; }

    .chat-body { padding: 12px; display: flex; flex-direction: column; gap: 8px; overflow: auto; }
    .chat-msg {
      font-size: .92rem;
      line-height: 1.4;
      background: rgba(255, 255, 255, .06);
      color: #eaeaea;
      padding: 8px 10px;
      border-radius: 12px;
      max-width: 85%;
    }
    .chat-msg.bot { align-self: flex-start; }
    .chat-msg.user { align-self: flex-end; background: var(--nav-teal); color: #fff; }

    .chat-input-row {
      display: flex;
      gap: 8px;
      padding: 12px;
      border-top: 1px solid rgba(255, 255, 255, .06);
      background: rgba(6, 14, 16, 0.96);
    }
    .chat-input-row input {
      flex: 1;
      background: rgba(255, 255, 255, .06);
      border: 1px solid rgba(255, 255, 255, .12);
      color: #fff;
      border-radius: 12px;
      padding: 10px 12px;
      font-family: inherit;
    }
    .chat-send {
      background: var(--nav-teal);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 14px;
      cursor: pointer;
      font-family: inherit;
      font-weight: 600;
    }

    /* ===== ADD ACCOUNT MODAL ===== */
    #addAccountModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.45);
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    #addAccountModal:not([hidden]) {
      display: flex;
    }

    #addAccountModal .account-card {
      position: relative;
      z-index: 2001;
      background: var(--panel);
      border-radius: 14px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
      width: 100%;
      max-width: 420px;
    }

    .icon-btn.sm { padding: 5px; border-radius: 9px; }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .content { margin-left: 0 !important; }
      .legal-footer { margin-left: 0 !important; }
      .footer-inner { flex-direction: column; align-items: flex-start; gap: 12px; }
      .footer-links { text-align: left; }
    }

    @media (max-width:540px) {
      .chat-fab { right: 14px; bottom: 88px; }
      .chat-panel { right: 14px; bottom: 148px; }
    }
  </style>
</head>
<body class="app dark">
  
  <div class="profile-background"></div>

  <!-- NAVBAR MOUNT POINT -->
  <div id="ml-navbar"></div>

  <main class="dashboard">
    <!-- CONTENT -->
    <section class="content" id="content">
      <div class="content-top">
        <div>
          <h1 class="page-title" data-i18n="accounts">Accounts</h1>
          <div class="greeting">
            Hi, <span class="user-name">Loading…</span>
          </div>
        </div>

        <button class="btn" id="addAccountBtn">
          <iconify-icon class="ic" icon="mdi:plus"></iconify-icon>
          <span data-i18n="addAccount">Add Account</span>
        </button>
      </div>

      <div class="tabs" role="tablist" aria-label="Account type">
        <button class="tab active" id="tabLive" role="tab" aria-selected="true" aria-controls="panelLive" data-i18n="live">Live</button>
        <button class="tab" id="tabDemo" role="tab" aria-selected="false" aria-controls="panelDemo" data-i18n="demo">Demo</button>
      </div>

      <div id="panelLive" role="tabpanel" aria-labelledby="tabLive">
        <div class="accounts-list" id="liveAccounts" data-type="live"></div>
      </div>

      <div id="panelDemo" role="tabpanel" aria-labelledby="tabDemo" hidden>
        <div class="accounts-list" id="demoAccounts" data-type="demo"></div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="legal-footer">
      <div class="footer-inner">
        <p class="footer-risk">
          <strong>⚠️ Risk Disclaimer:</strong><br><br>
          Trading in financial markets carries inherent risks, including the potential for loss of capital.
          Performance may vary based on market conditions, account size, risk tolerance, and execution
          environment. While Market Llama is built to deliver consistent, data driven performance through
          advanced automation and professional account management, no trading environment is completely
          without risk.
          <br><br>
          Users should understand that smaller accounts face higher exposure to volatility, faster drawdown
          cycles, and reduced margin flexibility compared to larger accounts. Larger accounts can withstand
          market fluctuations more effectively, but they are still subject to market risk and temporary
          performance deviations.
          <br><br>
          Market Llama operates as a technology-enabled, professional account management platform similar
          to institutional asset managers providing users with sophisticated trading systems, automated
          execution, and real-time risk controls. Our purpose is to optimize performance, protect user
          capital, and deliver institutional-grade trading outcomes.
          <br><br>
          By connecting your trading account to Market Llama, you acknowledge that every investment activity
          carries risk, and that results can vary across market conditions. We commit to operating
          transparently, managing accounts responsibly, and applying disciplined, data driven strategies
          designed to achieve consistent long-term performance.
        </p>

        <div class="footer-links">
          <ul class="footer-links-list">
            <li><a href="privacy.html">Privacy Policy</a></li>
            <li><a href="terms.html">Terms &amp; Conditions</a></li>
            <li><a href="#">Refund &amp; Billing Policy</a></li>
            <li><a href="#">Support</a></li>
            <li><a href="#">Whatsapp</a></li>
            <li><a href="#">Twitter</a></li>
            <li><a href="#">Instagram</a></li>
          </ul>
        </div>
      </div>
    </footer>
  </main>

  <!-- CHAT WIDGET -->
  <button id="chatFab" class="chat-fab" aria-label="Open chat" aria-controls="chatPanel">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"
         stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M20 3H4a2 2 0 0 0-2 2v12l4-4h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z" />
      <circle cx="9" cy="10" r="1.25" />
      <circle cx="12" cy="10" r="1.25" />
      <circle cx="15" cy="10" r="1.25" />
    </svg>
  </button>

  <div id="chatPanel" class="chat-panel" role="dialog" aria-label="Assistant chat"
       aria-modal="true" aria-hidden="true">
    <div class="chat-header">
      <div class="chat-title">Assistant</div>
      <button id="chatClose" class="chat-close" aria-label="Close chat">×</button>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-msg bot">Hi! How can I help?</div>
    </div>
    <form id="chatForm" class="chat-input-row">
      <input id="chatInput" type="text" placeholder="Type a message…" autocomplete="off" />
      <button class="chat-send" type="submit">Send</button>
    </form>
  </div>

  <!-- ADD ACCOUNT MODAL -->
  <div id="addAccountModal" hidden>
    <div class="account-card" style="max-width:420px;margin:auto;">
      <div class="card-head">
        <strong>Add Broker</strong>
        <button class="icon-btn sm" id="closeAddAccount">×</button>
      </div>

      <div class="card-body" style="flex-direction:column;align-items:stretch;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <span class="chip chip-broker">Deriv</span>
          <button class="btn" id="connectDerivModalBtn">
            <iconify-icon class="ic" icon="mdi:link-variant"></iconify-icon>
            Connect
          </button>
        </div>

        <p class="muted" style="margin-top:14px;">
          More brokers coming soon
        </p>
      </div>
    </div>
  </div>

  <!-- LOAD NAVBAR.JS FIRST -->
  <script src="components/navbar.js"></script>
  
  <!-- THEN PAGE SCRIPTS -->
  <script src="scripts/auth.js"></script>
  <script src="scripts/accounts.js"></script>

  <!-- TABS SCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabLive = document.getElementById('tabLive');
      const tabDemo = document.getElementById('tabDemo');
      const panelLive = document.getElementById('panelLive');
      const panelDemo = document.getElementById('panelDemo');

      function setTab(which) {
        const isLive = which === 'live';
        tabLive.classList.toggle('active', isLive);
        tabDemo.classList.toggle('active', !isLive);
        tabLive.setAttribute('aria-selected', String(isLive));
        tabDemo.setAttribute('aria-selected', String(!isLive));
        panelLive.hidden = !isLive;
        panelDemo.hidden = isLive;
      }

      if (tabLive && tabDemo) {
        tabLive.addEventListener('click', () => setTab('live'));
        tabDemo.addEventListener('click', () => setTab('demo'));
      }
    });
  </script>

  <!-- CHAT SCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const chatFab = document.getElementById('chatFab');
      const chatPanel = document.getElementById('chatPanel');
      const chatClose = document.getElementById('chatClose');
      const chatForm = document.getElementById('chatForm');
      const chatInput = document.getElementById('chatInput');
      const chatBody = document.getElementById('chatBody');

      function openChat() {
        chatPanel.classList.add('open');
        chatPanel.setAttribute('aria-hidden', 'false');
        if (chatInput) setTimeout(() => chatInput.focus(), 80);
      }
      function closeChat() {
        chatPanel.classList.remove('open');
        chatPanel.setAttribute('aria-hidden', 'true');
      }

      if (chatFab) {
        chatFab.addEventListener('click', (e) => {
          e.stopPropagation();
          chatPanel.classList.contains('open') ? closeChat() : openChat();
        });
      }

      if (chatClose) {
        chatClose.addEventListener('click', (e) => {
          e.stopPropagation();
          closeChat();
        });
      }

      document.addEventListener('click', (e) => {
        if (!chatPanel.classList.contains('open')) return;
        if (chatPanel.contains(e.target) || chatFab.contains(e.target)) return;
        e.preventDefault();
        e.stopPropagation();
        closeChat();
      }, true);

      if (chatForm && chatInput && chatBody) {
        chatForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const text = chatInput.value.trim();
          if (!text) return;
          const msg = document.createElement('div');
          msg.className = 'chat-msg user';
          msg.textContent = text;
          chatBody.appendChild(msg);
          chatInput.value = '';
          chatBody.scrollTop = chatBody.scrollHeight;
        });
      }
    });
  </script>

  <!-- ADD ACCOUNT MODAL SCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const addBtn = document.getElementById('addAccountBtn');
      const modal = document.getElementById('addAccountModal');
      const closeBtn = document.getElementById('closeAddAccount');

      if (!addBtn || !modal) return;

      addBtn.addEventListener('click', () => {
        modal.hidden = false;
      });

      closeBtn?.addEventListener('click', () => {
        modal.hidden = true;
      });

      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.hidden = true;
      });
    });
  </script>
</body>
</html>