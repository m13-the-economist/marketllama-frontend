<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Accounts ‚Äî Fintech Platform</title>
  <meta name="description" content="Manage live, demo, and archived trading accounts." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
  <link rel="icon" type="image/svg+xml"
    href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="30" fill="%234169E1"/><path d="M20 34h24v6H20zM20 24h18v6H20z" fill="white"/></svg>' />
  <style>
    :root {
      --header-h: 60px;
      --bg: #0b0b0c;
      --panel: #121214;
      --muted: #8f8f92;
      --text: #ffffff;
      --accent: #ffffff;
      --accent-plain: #dadada;
      --glow: rgba(255, 255, 255, .06);
      --glass: rgba(255, 255, 255, .04);
      --ring: rgba(255, 255, 255, .12);
      --pill: #16171a;
      --shadow: 0 8px 24px rgba(0, 0, 0, .45);
      --accent-main: #00c8ff;
      --nav-teal: #1a6d72;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 14px;
    }

    body.app.dark {
      background: var(--bg);
      color: var(--text);
      font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow-x: hidden;
    }

    /* Header */
    .site-header {
      position: fixed;
      inset: 0 0 auto 0;
      height: var(--header-h);
      z-index: 40;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 8px 14px;
      background: #0097b2;
      border-bottom: 1px solid var(--ring);
      backdrop-filter: blur(8px);
    }

    .site-header .left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text);
      text-decoration: none;
      font-weight: 700;
    }

    .logo {
      width: 26px;
      height: 26px;
      border-radius: 8px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .logo-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
      display: block;
    }

    .brand-name {
      letter-spacing: .2px;
      font-size: 1rem;
    }

    .site-actions {
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .icon-btn {
      background: transparent;
      border: 1px solid var(--ring);
      color: var(--text);
      padding: 6px 8px;
      border-radius: 10px;
      cursor: pointer;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      text-decoration: none;
    }

    .icon-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-1px);
    }

    .icon-btn.sm {
      padding: 5px;
      border-radius: 9px;
    }

    .balance-wrap {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 5px 8px;
      border: 1px solid var(--ring);
      border-radius: 10px;
      background: var(--glass);
    }

    .balance-amount {
      letter-spacing: .2px;
      font-size: .95rem;
    }

    /* Language Dropdown */
    .language-dropdown {
      position: absolute;
      top: 100%;
      right: 120px;
      background: rgba(20, 20, 20, 0.95);
      border: 1px solid var(--ring);
      border-radius: 12px;
      padding: 8px;
      min-width: 160px;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      z-index: 1000;
    }

    .lang-option {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 10px 12px;
      background: transparent;
      border: none;
      color: var(--text);
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s ease;
      font-family: inherit;
      font-size: 14px;
    }

    .lang-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .flag {
      font-size: 16px;
    }

    .mobile-only {
      display: none;
    }

    .desktop-only {
      display: inline-flex;
    }

    .ic {
      font-size: 18px;
      line-height: 1;
      vertical-align: middle;
      opacity: 0.9;
      transition: opacity 0.2s ease;
    }

    .icon-btn:hover .ic {
      opacity: 1;
    }

    .side .ic {
      font-size: 18px;
    }

    /* Layout */
    .dashboard {
      min-height: 100vh;
      padding-top: var(--header-h);
    }

    .side {
      position: fixed;
      top: var(--header-h);
      left: 0;
      bottom: 0;
      z-index: 30;
      width: 240px;
      overflow-y: auto;
      border-right: 1px solid var(--ring);
      background: linear-gradient(180deg, rgba(255, 255, 255, .04), rgba(255, 255, 255, .02));
      transition: left .3s ease, width .25s ease;
    }

    .side[data-state="collapsed"] {
      width: 68px;
    }

    .side .label {
      transition: opacity .2s ease;
    }

    .side[data-state="collapsed"] .label {
      opacity: 0;
      pointer-events: none;
    }

    .side-toggle {
      position: sticky;
      bottom: 0;
      width: 100%;
      background: rgb(75, 75, 75);
      margin-top: 6px;
      border: none;
      color: white;
      padding: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .side-menu {
      list-style: none;
      margin: 8px 0 48px;
      padding: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .side-menu a,
    .accordion {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      text-decoration: none;
      color: var(--accent-plain);
      background: transparent;
      border: 1px solid transparent;
      padding: 8px 10px;
      border-radius: 10px;
      cursor: pointer;
    }

    .side-menu li.active>a {
      background: var(--glass);
      border-color: var(--ring);
      color: var(--text);
    }

    .has-submenu {
      position: relative;
    }

    .accordion {
      background: none;
      border: none;
      transition: all 0.3s ease;
    }

    .accordion:hover {
      background: rgba(255, 255, 255, 0.05);
      border-color: var(--ring);
    }

    .accordion .chevron {
      margin-left: auto;
      transition: transform 0.3s ease;
    }

    .accordion[aria-expanded="true"] .chevron {
      transform: rotate(180deg);
    }

    .accordion[aria-expanded="true"] {
      background: var(--glass);
      border-color: var(--ring);
      color: var(--text);
    }

    .submenu {
      list-style: none;
      padding-left: 20px;
      margin: 4px 0 0;
      background: rgba(0, 0, 0, 0.2);
      border-left: 2px solid #4169E1;
      border-radius: 0 0 8px 8px;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .side[data-state="collapsed"] .submenu {
      display: none !important;
    }

    .submenu li {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .submenu li:last-child {
      border-bottom: none;
    }

    .submenu a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      border: none;
      border-radius: 6px;
      margin: 2px 4px;
      width: calc(100% - 8px);
    }

    .submenu a:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .content {
      margin-left: 240px;
      padding: 18px clamp(12px, 2vw, 24px);
      transition: margin-left 0.25s ease;
    }

    .side[data-state="collapsed"]~.content {
      margin-left: 68px;
    }

    .content-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 8px 0 16px;
    }

    .page-title {
      font-size: clamp(22px, 3vw, 42px);
      font-weight: 800;
      letter-spacing: .3px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 12px;
      border: 1px solid var(--ring);
      background: var(--glass);
      color: var(--text);
      cursor: pointer;
      box-shadow: var(--shadow);
      font-size: .95rem;
    }

    .btn.btn-primary {
      background: #1a1b1f;
    }

    .btn.btn-pill {
      border-radius: 999px;
    }

    .badge.badge-pro {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background: #cc7a00;
      border: 1px solid var(--ring);
      padding: 5px 8px;
      border-radius: 999px;
      margin-left: 6px;
      font-size: .85rem;
    }

    .greeting {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin: 8px 0 14px;
    }

    .tab {
      background: #1a1b1f;
      border: 1px solid var(--ring);
      color: var(--accent-plain);
      padding: 8px 16px;
      border-radius: 999px;
      cursor: pointer;
      font-size: .95rem;
    }

    .tab.active {
      background: var(--text);
      color: #000;
    }

    .chip {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 999px;
      background: #1a1b1f;
      border: 1px solid var(--ring);
      font-size: .8rem;
      margin-right: 8px;
    }

    .chip-live {
      background: #4CAF50;
      color: white;
    }

    .chip-demo {
      background: #FF9800;
      color: white;
    }

    .chip-broker {
      background: #2196F3;
      color: white;
    }

    .account-card {
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255, 255, 255, .04), rgba(255, 255, 255, .02));
      border: 1px solid var(--ring);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 14px;
      margin-bottom: 10px;
    }

    .card-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .card-body {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 6px 16px;
    }

    .big-amount {
      font-size: 16px;
      font-weight: 500;
      letter-spacing: 1.4px;
    }

    .card-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .btn-ghost {
      background: #1a1b1f;
      padding: 10px 14px;
      border: 1px solid var(--ring);
    }

    .line-art {
      position: absolute;
      inset: -10% -5% auto auto;
      height: 120%;
      width: 70%;
      pointer-events: none;
      opacity: .18;
      filter: blur(.2px);
      background:
        radial-gradient(100px 120px at 40% 35%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(120px 160px at 55% 48%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%),
        radial-gradient(160px 220px at 65% 60%, transparent 30%, rgba(255, 255, 255, .05) 32%, transparent 34%);
    }

    .backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .45);
      z-index: 35;
      backdrop-filter: blur(2px);
    }

    .video-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -1;
    }

    .video-background video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
    }

    /* Add Account Modal */
    .add-account-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .add-account-modal-overlay.open {
      display: flex;
    }

    .add-account-modal {
      width: 100%;
      max-width: 520px;
      background: #080b11;
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.75);
      padding: 22px 24px 20px;
      position: relative;
    }

    .add-account-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .add-account-modal-title {
      font-size: 18px;
      font-weight: 700;
    }

    .add-account-modal-subtitle {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .modal-close-btn {
      border: none;
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      padding: 4px;
      border-radius: 999px;
      line-height: 1;
    }

    .modal-close-btn:hover {
      background: rgba(255, 255, 255, 0.06);
      color: var(--text);
    }

    .input-group {
      margin-bottom: 14px;
    }

    .input-label {
      font-size: 12px;
      margin-bottom: 6px;
      display: block;
    }

    .input-control {
      width: 100%;
      padding: 9px 11px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: #05070d;
      color: var(--text);
      font-family: inherit;
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    .input-control::placeholder {
      color: rgba(255, 255, 255, 0.35);
    }

    .input-control:focus {
      border-color: var(--accent-main);
      box-shadow: 0 0 0 1px rgba(0, 200, 255, 0.2);
      background: #050812;
    }

    .helper-text {
      font-size: 11px;
      color: var(--muted);
      margin-top: 4px;
    }

    .error-message {
      font-size: 11px;
      color: #ff6b6b;
      margin-top: 4px;
      display: none;
    }

    /* Broker searchable dropdown */
    .broker-select {
      position: relative;
    }

    .broker-input {
      padding-right: 32px;
    }

    .broker-dropdown-toggle {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      color: var(--muted);
      cursor: pointer;
      padding: 4px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .broker-dropdown-toggle:hover {
      background: rgba(255, 255, 255, 0.06);
      color: var(--text);
    }

    .broker-options {
      position: absolute;
      left: 0;
      right: 0;
      top: calc(100% + 6px);
      background: #05070d;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      max-height: 180px;
      overflow-y: auto;
      display: none;
      z-index: 20;
    }

    .broker-options.open {
      display: block;
    }

    .broker-option {
      width: 100%;
      text-align: left;
      padding: 8px 12px;
      background: transparent;
      border: none;
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
      font-family: inherit;
    }

    .broker-option:hover {
      background: rgba(255, 255, 255, 0.06);
    }

    .broker-option-empty {
      color: var(--muted);
      cursor: default;
    }

    .add-account-modal-footer {
      margin-top: 16px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn-secondary {
      background: transparent;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      padding-inline: 16px;
      font-size: 13px;
    }

    .btn-primary-main {
      border-radius: 999px;
      border: none;
      background: var(--accent-main);
      color: #020308;
      font-weight: 600;
      padding-inline: 20px;
      font-size: 13px;
    }

    .btn-primary-main[disabled] {
      opacity: 0.6;
      cursor: default;
    }

    @media (max-width: 600px) {
      .add-account-modal {
        margin: 0 14px;
        padding-inline: 18px;
      }

      .add-account-modal-footer {
        flex-direction: column-reverse;
        align-items: stretch;
      }

      .add-account-modal-footer .btn {
        width: 100%;
        justify-content: center;
      }
    }

    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: rgba(8, 12, 20, 0.95);
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 12px;
      border: 1px solid rgba(0, 200, 255, 0.5);
      box-shadow: 0 14px 40px rgba(0, 0, 0, 0.7);
      opacity: 0;
      transform: translateY(10px);
      pointer-events: none;
      transition: opacity 0.25s ease, transform 0.25s ease;
      z-index: 60;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    @media (max-width: 600px) {
      .toast {
        left: 50%;
        right: auto;
        transform: translate(-50%, 10px);
      }

      .toast.show {
        transform: translate(-50%, 0);
      }
    }

    @media (max-width: 1100px) {
      .desktop-only {
        display: none;
      }
      .mobile-only {
        display: inline-flex;
      }
    }

    @media (max-width: 1024px) {
      .side[data-state="expanded"] {
        width: 200px;
      }
      .content {
        margin-left: 200px;
      }
      .legal-footer {
        margin-left: 200px;
      }
    }

    @media (max-width: 768px) {
      .side {
        left: -240px;
        width: 240px;
      }
      .side.open {
        left: 0;
      }
      .content {
        margin-left: 0;
      }
      .language-dropdown {
        right: 10px;
        min-width: 140px;
      }
      .legal-footer {
        margin-left: 0;
      }
      .footer-inner {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
      .footer-links {
        text-align: left;
      }
    }

    @media (min-width: 769px) {
      .content {
        margin-left: 240px;
      }
    }

    /* Persistent Legal Footer ‚Äì a bit lower */
    .legal-footer {
      margin-left: 240px;
      margin-top: 24px;
      padding: 18px clamp(12px, 2vw, 24px);
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--muted);
      font-size: 13px;
    }

    .side[data-state="collapsed"] ~ .legal-footer {
      margin-left: 68px;
    }

    .footer-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 24px;
    }

    .footer-risk {
      line-height: 1.7;
      max-width: 720px;
    }

    .footer-links {
      text-align: right;
      font-size: 13px;
    }

    .footer-links-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .footer-links a {
      color: var(--accent-plain);
      text-decoration: none;
      opacity: 0.9;
      transition: opacity 0.2s ease, text-decoration-color 0.2s ease;
    }

    .footer-links a:hover {
      opacity: 1;
      text-decoration: underline;
    }

    /* ===== Chat widget ‚Äì teal variant (aligned with chart page) ===== */
    .chat-fab {
      position: fixed;
      right: 20px;
      bottom: 88px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--nav-teal);
      color: #eaeaea;
      border: 1px solid rgba(255, 255, 255, .18);
      cursor: pointer;
      z-index: 1100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 24px rgba(0, 0, 0, .45);
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
      backdrop-filter: blur(8px);
    }

    .chat-fab:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(0, 0, 0, .5);
      background: #20848a;
    }

    .chat-fab svg {
      width: 24px;
      height: 24px;
      stroke: currentColor;
    }

    .chat-panel {
      position: fixed;
      right: 20px;
      bottom: 156px;
      width: min(420px, 92vw);
      max-height: 72vh;
      background: rgba(8, 20, 24, .96);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(26, 109, 114, 0.6);
      border-radius: 16px;
      z-index: 1200;
      display: flex;
      flex-direction: column;
      opacity: 0;
      transform: translateY(8px) scale(.98);
      pointer-events: none;
      transition: opacity .2s ease, transform .2s ease;
      color: #fff;
      overflow: hidden;
    }

    .chat-panel.open {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: auto;
    }

    .chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(255, 255, 255, .06);
      background: var(--nav-teal);
    }

    .chat-title {
      font-weight: 600;
    }

    .chat-close {
      background: none;
      border: none;
      color: #fff;
      font-size: 22px;
      cursor: pointer;
      line-height: 1;
    }

    .chat-body {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: auto;
    }

    .chat-msg {
      font-size: .92rem;
      line-height: 1.4;
      background: rgba(255, 255, 255, .06);
      color: #eaeaea;
      padding: 8px 10px;
      border-radius: 12px;
      max-width: 85%;
    }

    .chat-msg.bot {
      align-self: flex-start;
    }

    .chat-msg.user {
      align-self: flex-end;
      background: var(--nav-teal);
      color: #fff;
    }

    .chat-input-row {
      display: flex;
      gap: 8px;
      padding: 12px;
      border-top: 1px solid rgba(255, 255, 255, .06);
      background: rgba(6, 14, 16, 0.96);
    }

    .chat-input-row input {
      flex: 1;
      background: rgba(255, 255, 255, .06);
      border: 1px solid rgba(255, 255, 255, .12);
      color: #fff;
      border-radius: 12px;
      padding: 10px 12px;
    }

    .chat-send {
      background: var(--nav-teal);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 14px;
      cursor: pointer;
    }

    @media (max-width:540px) {
      .chat-fab {
        right: 14px;
        bottom: 88px;
      }

      .chat-panel {
        right: 14px;
        bottom: 148px;
      }
    }
  </style>
  <script src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>
</head>
<body class="app dark">

  <div class="video-background">
    <video autoplay muted playsinline>
      <source src="hi5.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>

  <header class="site-header" id="siteHeader">
    <div class="left">
      <button class="icon-btn mobile-only" id="mobileSideTrigger" aria-label="Toggle menu" aria-controls="sidebar" aria-expanded="false">
        <iconify-icon class="ic" icon="mdi:menu"></iconify-icon>
      </button>
      <a href="plans.html" class="brand">
        <div class="logo">
          <img src="llama.webp" alt="Market Llama" class="logo-img" loading="lazy" />
        </div>
        <span class="brand-name">Market Llama</span>
      </a>
    </div>
    <nav class="site-actions">
      <button class="icon-btn" id="qrBtn" aria-label="QR"><iconify-icon class="ic" icon="mdi:qrcode"></iconify-icon></button>
      <div class="balance-wrap">
        <span class="balance-amount" id="topBalance">$ 15 400.00</span>
        <button class="icon-btn" id="toggleBalance" aria-label="Hide balance">
          <iconify-icon class="ic" id="topEye" icon="mdi:eye-outline"></iconify-icon>
        </button>
      </div>

      <button class="icon-btn" id="languageBtn" aria-label="Language">
        <iconify-icon class="ic" icon="mdi:translate"></iconify-icon>
      </button>
      <div class="language-dropdown" id="languageDropdown" hidden>
        <button class="lang-option" data-lang="en"><span class="flag">üá∫üá∏</span> English</button>
        <button class="lang-option" data-lang="de"><span class="flag">üá©üá™</span> Deutsch</button>
        <button class="lang-option" data-lang="es"><span class="flag">üá™üá∏</span> Espa√±ol</button>
        <button class="lang-option" data-lang="fr"><span class="flag">üá´üá∑</span> Fran√ßais</button>
        <button class="lang-option" data-lang="ar"><span class="flag">üá∏üá¶</span> ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
      </div>

      <button class="icon-btn" aria-label="Notifications"><iconify-icon class="ic" icon="mdi:bell-outline"></iconify-icon></button>
      <button class="icon-btn" aria-label="Support"><iconify-icon class="ic" icon="mdi:headphones"></iconify-icon></button>
      <a href="profile.html" class="icon-btn" aria-label="Profile" data-link="profile">
        <iconify-icon class="ic" icon="mdi:account-circle-outline"></iconify-icon>
      </a>
    </nav>
  </header>

  <div class="backdrop" id="backdrop" hidden></div>

  <main class="dashboard">
    <aside class="side" id="sidebar" aria-label="Primary" data-state="expanded">
      <div class="side-toggle desktop-only" id="sideToggle" aria-label="Collapse sidebar" aria-expanded="true">
        <iconify-icon class="ic" icon="mdi:chevron-double-left"></iconify-icon>
      </div>
      <ul class="side-menu">
        <li class="active">
          <a href="#">
            <iconify-icon class="ic" icon="mdi:view-dashboard-outline"></iconify-icon>
            <span class="label" data-i18n="accounts">Accounts</span>
          </a>
        </li>

        <li class="has-submenu">
          <button class="accordion" aria-expanded="false">
            <iconify-icon class="ic" icon="mdi:wallet-outline"></iconify-icon>
            <span class="label" data-i18n="paymentsWallet">Payments &amp; Wallet</span>
            <iconify-icon class="ic chevron" icon="mdi:chevron-down"></iconify-icon>
          </button>
          <ul class="submenu" hidden>
            <li>
              <a href="subscriptionplan.html">
                <iconify-icon class="ic" icon="mdi:currency-usd"></iconify-icon>
                <span data-i18n="subscription">Subscription Plan</span>
              </a>
            </li>
            <li>
              <a href="#">
                <iconify-icon class="ic" icon="mdi:history"></iconify-icon>
                <span data-i18n="transactionHistory">Transaction History</span>
              </a>
            </li>
          </ul>
        </li>

        <li>
          <a href="insight.html" data-link="insight">
            <iconify-icon class="ic" icon="mdi:map-marker-outline"></iconify-icon>
            <span class="label" data-i18n="insight">Insight</span>
          </a>
        </li>

        <li>
          <a href="performance.html" data-link="performance">
            <iconify-icon class="ic" icon="mdi:cpu-64-bit"></iconify-icon>
            <span class="label" data-i18n="performance">Performance</span>
          </a>
        </li>

        <li>
          <a href="chart.html" data-link="chart">
            <iconify-icon class="ic" icon="mdi:chart-bar"></iconify-icon>
            <span class="label" data-i18n="chart">Chart</span>
          </a>
        </li>

        <li>
          <a href="instructions.html" data-link="instructions">
            <iconify-icon class="ic" icon="mdi:book-open-outline"></iconify-icon>
            <span class="label" data-i18n="instructions">Instructions</span>
          </a>
        </li>

        <li>
          <a href="profile.html" data-link="profile">
            <iconify-icon class="ic" icon="mdi:cog-outline"></iconify-icon>
            <span class="label" data-i18n="settings">Settings</span>
          </a>
        </li>
      </ul>
    </aside>

    <section class="content" id="content">
      <div class="content-top">
        <h1 class="page-title" data-i18n="accounts">Accounts</h1>
        <button class="btn btn-primary btn-pill add-account-btn" style="margin-right:10px" data-i18n-button="openNewAccount">
          <iconify-icon class="ic" icon="mdi:plus"></iconify-icon>
          <span>Add Account</span>
        </button>
      </div>

      <div class="greeting">
        <div class="hello" style="margin-bottom:25px;" data-i18n="greeting">Hi, Gafar Akinfolayan .</div>
        <div class="tier">
          <span class="badge badge-pro" style="margin-right:70px">
            <iconify-icon class="ic" icon="mdi:medal-outline"></iconify-icon>
            <span data-i18n="pro">Pro</span>
          </span>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="live" data-i18n="live">Live</button>
        <button class="tab" data-tab="demo" data-i18n="demo">Demo</button>
      </div>

      <!-- Live card -->
      <div class="account-card active" data-account-type="live">
        <div class="card-head">
          <span class="chip chip-live" data-i18n="live">Live</span>
          <span class="chip chip-broker">Deriv</span>
        </div>
        <div class="card-body">
          <div class="big-amount">
            <span style="font-size:21px">15,400</span>.00 <span>USD</span>
          </div>
          <button class="icon-btn sm" id="cardBalanceToggle" aria-label="Hide balance">
            <iconify-icon class="ic" id="cardEye" icon="mdi:eye-outline"></iconify-icon>
          </button>
        </div>
        <div class="line-art" aria-hidden="true"></div>
      </div>

      <!-- Demo card -->
      <div class="account-card" data-account-type="demo" hidden>
        <div class="card-head">
          <span class="chip chip-demo" data-i18n="demo">Demo</span>
          <span class="chip chip-broker">Deriv</span>
        </div>
        <div class="card-body">
          <div class="big-amount">
            <span style="font-size:21px">10,000</span>.00 <span>USD</span>
          </div>
          <div class="card-actions">
            <button class="btn btn-ghost demo-reset">
              <iconify-icon class="ic" icon="mdi:download"></iconify-icon>
              <span data-i18n="reset">Reset</span>
            </button>
            <button class="icon-btn sm" id="cardBalanceToggleDemo" aria-label="Hide balance">
              <iconify-icon class="ic" id="cardEyeDemo" icon="mdi:eye-outline"></iconify-icon>
            </button>
          </div>
        </div>
        <div class="line-art" aria-hidden="true"></div>
      </div>
    </section>
    

    <footer class="legal-footer">
      <div class="footer-inner">
        <p class="footer-risk">
          <strong>‚ö†Ô∏è Risk Disclaimer:</strong><br><br>
          Trading in financial markets carries inherent risks, including the potential for loss of capital.
          Performance may vary based on market conditions, account size, risk tolerance, and execution
          environment. While Market Llama is built to deliver consistent, data driven performance through
          advanced automation and professional account management, no trading environment is completely
          without risk.
          <br><br>
          Users should understand that smaller accounts face higher exposure to volatility, faster drawdown
          cycles, and reduced margin flexibility compared to larger accounts. Larger accounts can withstand
          market fluctuations more effectively, but they are still subject to market risk and temporary
          performance deviations.
          <br><br>
          Market Llama operates as a technology-enabled, professional account management platform  similar
          to institutional asset managers providing users with sophisticated trading systems, automated
          execution, and real-time risk controls. Our purpose is to optimize performance, protect user
          capital, and deliver institutional-grade trading outcomes.
          <br><br>
          By connecting your trading account to Market Llama, you acknowledge that every investment activity
          carries risk, and that results can vary across market conditions. We commit to operating
          transparently, managing accounts responsibly, and applying disciplined, data driven strategies
          designed to achieve consistent long-term performance.
        </p>
        <div class="footer-links">
          <ul class="footer-links-list">
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Terms &amp; Conditions</a></li>
            <li><a href="#">Refund &amp; Billing Policy</a></li>
            <li><a href="#">support</a></li>
            <li><a href="#">Whatsapp</a></li>
            <li><a href="#">Twitter</a></li>
            <li><a href="#">instagram</a></li>
          </ul>
        </div>
      </div>
    </footer>
  </main>

  <!-- CHAT WIDGET -->
  <button id="chatFab" class="chat-fab" aria-label="Open chat" aria-controls="chatPanel">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"
         stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d="M20 3H4a2 2 0 0 0-2 2v12l4-4h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z" />
      <circle cx="9" cy="10" r="1.25" />
      <circle cx="12" cy="10" r="1.25" />
      <circle cx="15" cy="10" r="1.25" />
    </svg>
  </button>

  <div id="chatPanel" class="chat-panel" role="dialog" aria-label="Assistant chat"
       aria-modal="true" aria-hidden="true">
    <div class="chat-header">
      <div class="chat-title">Assistant</div>
      <button id="chatClose" class="chat-close" aria-label="Close chat">√ó</button>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-msg bot">Hi! How can I help?</div>
    </div>
    <form id="chatForm" class="chat-input-row">
      <input id="chatInput" type="text" placeholder="Type a message‚Ä¶" autocomplete="off" />
      <button class="chat-send" type="submit">Send</button>
    </form>
  </div>

  <div class="add-account-modal-overlay" id="addAccountOverlay" aria-hidden="true">
    <div class="add-account-modal" role="dialog" aria-modal="true" aria-labelledby="addAccountTitle">
      <div class="add-account-modal-header">
        <h2 class="add-account-modal-title" id="addAccountTitle">Add Account</h2>
        <button class="modal-close-btn" id="addAccountCloseBtn" aria-label="Close">
          <iconify-icon icon="mdi:close"></iconify-icon>
        </button>
      </div>
      <p class="add-account-modal-subtitle">
        Securely connect your trading account to Market Llama.
      </p>

      <form id="addAccountForm" novalidate>
        <div class="input-group" data-field="name">
          <label class="input-label" for="accountName">Account Name</label>
          <input id="accountName" class="input-control" type="text" placeholder="e.g. VIX75 Scalping Account">
          <div class="error-message">Please enter an account name.</div>
        </div>

        <div class="input-group" data-field="broker">
          <label class="input-label" for="brokerInput">Broker</label>
          <div class="broker-select">
            <input
              id="brokerInput"
              class="input-control broker-input"
              type="text"
              placeholder="Search broker e.g. Deriv"
              autocomplete="off"
            >
            <button type="button" class="broker-dropdown-toggle" id="brokerToggle" aria-label="Toggle broker list">
              <iconify-icon icon="mdi:chevron-down"></iconify-icon>
            </button>
            <div class="broker-options" id="brokerOptions"></div>
          </div>
          <div class="error-message">Please select a broker.</div>
        </div>

        <div class="input-group" data-field="login">
          <label class="input-label" for="accountLogin">Account Login ID</label>
          <input id="accountLogin" class="input-control" type="text" placeholder="e.g. CR1234567">
          <div class="error-message">Please enter your login ID.</div>
        </div>

        <div class="input-group" data-field="token">
          <label class="input-label" for="apiToken">API Token</label>
          <input id="apiToken" class="input-control" type="password" placeholder="Paste your API token here.">
          <div class="helper-text">
            Generate this from your dashboard. We never show it again after saving.
          </div>
          <div class="error-message">Please enter your API token.</div>
        </div>

        <div class="add-account-modal-footer">
          <button type="button" class="btn btn-secondary" id="addAccountCancelBtn">Cancel</button>
          <button type="submit" class="btn btn-primary-main" id="addAccountSaveBtn">Save</button>
        </div>
      </form>
    </div>
  </div>

  <div class="toast" id="addAccountToast"> account added successfully.</div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const params = new URLSearchParams(window.location.search);
      let currentLang = params.get('lang') || 'en';

      const translations = {
        en: {
          accounts: "Accounts",
          paymentsWallet: "Payments & Wallet",
          subscription: "Subscription Plan",
          deposit: "Deposit",
          withdrawal: "Withdrawal",
          transactionHistory: "Transaction History",
          insight: "Insight",
          performance: "Performance",
          chart: "Chart",
          settings: "Settings",
          instructions: "Instructions",
          openNewAccount: "Add Account",
          live: "Live",
          demo: "Demo",
          archived: "Archived",
          reset: "Reset",
          practice: "Practice",
          restore: "Restore",
          delete: "Delete",
          greeting: "Hi, Gafar Akinfolayan .",
          pro: "Pro"
        },
        de: {
          accounts: "Konten",
          paymentsWallet: "Zahlungen & Wallet",
          subscription: "Abonnementplan",
          deposit: "Einzahlung",
          withdrawal: "Auszahlung",
          transactionHistory: "Transaktionsverlauf",
          insight: "Einblicke",
          performance: "Leistung",
          chart: "Diagramm",
          settings: "Einstellungen",
          instructions: "Anleitung",
          openNewAccount: "Konto hinzuf√ºgen",
          live: "Live",
          demo: "Demo",
          archived: "Archiviert",
          reset: "Zur√ºcksetzen",
          practice: "√úben",
          restore: "Wiederherstellen",
          delete: "L√∂schen",
          greeting: "Hallo, Gafar Akinfolayan.",
          pro: "Profi"
        },
        es: {
          accounts: "Cuentas",
          paymentsWallet: "Pagos & Cartera",
          subscription: "Plan de Suscripci√≥n",
          deposit: "Depositar",
          withdrawal: "Retirar",
          transactionHistory: "Historial de Transacciones",
          insight: "Perspectiva",
          performance: "Rendimiento",
          chart: "Gr√°fico",
          settings: "Configuraci√≥n",
          instructions: "Instrucciones",
          openNewAccount: "Agregar cuenta",
          live: "En Vivo",
          demo: "Demo",
          archived: "Archivado",
          reset: "Reiniciar",
          practice: "Practicar",
          restore: "Restaurar",
          delete: "Eliminar",
          greeting: "Hola, Gafar Akinfolayan.",
          pro: "Pro"
        },
        fr: {
          accounts: "Comptes",
          paymentsWallet: "Paiements & Portefeuille",
          subscription: "Plan d'abonnement",
          deposit: "D√©p√¥t",
          withdrawal: "Retrait",
          transactionHistory: "Historique des transactions",
          insight: "Aper√ßu",
          performance: "Performance",
          chart: "Graphique",
          settings: "Param√®tres",
          instructions: "Instructions",
          openNewAccount: "Ajouter un compte",
          live: "En Direct",
          demo: "D√©mo",
          archived: "Archiv√©",
          reset: "R√©initialiser",
          practice: "Pratique",
          restore: "Restaurer",
          delete: "Supprimer",
          greeting: "Bonjour, Gafar Akinfolayan.",
          pro: "Pro"
        },
        ar: {
          accounts: "ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™",
          paymentsWallet: "ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ŸàÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©",
          subscription: "ÿÆÿ∑ÿ© ÿßŸÑÿßÿ¥ÿ™ÿ±ÿßŸÉ",
          deposit: "ÿ•ŸäÿØÿßÿπ",
          withdrawal: "ÿ≥ÿ≠ÿ®",
          transactionHistory: "ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖÿπÿßŸÖŸÑÿßÿ™",
          insight: "ÿ±ÿ§Ÿâ",
          performance: "ÿßŸÑÿ£ÿØÿßÿ°",
          chart: "ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä",
          settings: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
          instructions: "ÿßŸÑÿ™ÿπŸÑŸäŸÖÿßÿ™",
          openNewAccount: "ÿ•ÿ∂ÿßŸÅÿ© ÿ≠ÿ≥ÿßÿ®",
          live: "ÿ≠ŸÇŸäŸÇŸä",
          demo: "ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä",
          archived: "ŸÖÿ§ÿ±ÿ¥ŸÅ",
          reset: "ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ",
          practice: "ÿ™ÿ¨ÿ±ÿ®ÿ©",
          restore: "ÿßÿ≥ÿ™ÿπÿßÿØÿ©",
          delete: "ÿ≠ÿ∞ŸÅ",
          greeting: "ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ÿ∫ŸÅÿßÿ± ÿ£ŸÉŸÜŸÅŸàŸÑÿßŸäŸÜ.",
          pro: "ŸÖÿ≠ÿ™ÿ±ŸÅ"
        }
      };

      if (!translations[currentLang]) currentLang = 'en';

      function updateNavLinks() {
        const profileLinks = document.querySelectorAll('[data-link="profile"]');
        profileLinks.forEach(a => {
          const href = a.getAttribute('href') || 'profile.html';
          const url = new URL(href, window.location.origin + window.location.pathname);
          url.searchParams.set('lang', currentLang);
          a.setAttribute('href', url.pathname + '?' + url.searchParams.toString());
        });

        const insightLinks = document.querySelectorAll('[data-link="insight"]');
        insightLinks.forEach(a => {
          const href = a.getAttribute('href') || 'insight.html';
          const url = new URL(href, window.location.origin + window.location.pathname);
          url.searchParams.set('lang', currentLang);
          a.setAttribute('href', url.pathname + '?' + url.searchParams.toString());
        });

        const chartLinks = document.querySelectorAll('[data-link="chart"]');
        chartLinks.forEach(a => {
          const href = a.getAttribute('href') || 'chart.html';
          const url = new URL(href, window.location.origin + window.location.pathname);
          url.searchParams.set('lang', currentLang);
          a.setAttribute('href', url.pathname + '?' + url.searchParams.toString());
        });
      }

      function applyLanguage(lang) {
        const t = translations[lang] || translations.en;

        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (t[key]) el.textContent = t[key];
        });

        const openBtn = document.querySelector('[data-i18n-button="openNewAccount"]');
        if (openBtn) {
          const icon = openBtn.querySelector('iconify-icon');
          openBtn.innerHTML = '';
          if (icon) openBtn.appendChild(icon);
          const span = document.createElement('span');
          span.textContent = t.openNewAccount;
          openBtn.appendChild(span);
        }

        if (lang === 'ar') {
          document.documentElement.setAttribute('dir', 'rtl');
        } else {
          document.documentElement.setAttribute('dir', 'ltr');
        }

        updateNavLinks();
      }

      const tabs = document.querySelectorAll('.tab');
      const cards = document.querySelectorAll('.account-card');

      tabs.forEach(tab => {
        tab.addEventListener('click', (e) => {
          e.stopPropagation();
          const type = tab.getAttribute('data-tab');
          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          cards.forEach(card => {
            const ct = card.getAttribute('data-account-type');
            if (ct === type) {
              card.hidden = false;
              card.classList.add('active');
            } else {
              card.hidden = true;
              card.classList.remove('active');
            }
          });
        });
      });

      const accordion = document.querySelector('.accordion');
      const submenu = document.querySelector('.submenu');
      const chevron = document.querySelector('.chevron');

      function closeDropdown() {
        if (submenu && !submenu.hidden) {
          submenu.hidden = true;
          if (accordion) accordion.setAttribute('aria-expanded', 'false');
          if (chevron) chevron.setAttribute('icon', 'mdi:chevron-down');
        }
      }

      if (accordion && submenu && chevron) {
        accordion.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          const isExpanded = accordion.getAttribute('aria-expanded') === 'true';
          accordion.setAttribute('aria-expanded', String(!isExpanded));
          submenu.hidden = isExpanded;
          chevron.setAttribute('icon', isExpanded ? 'mdi:chevron-down' : 'mdi:chevron-up');
        });
      }

      const mobileSideTrigger = document.getElementById('mobileSideTrigger');
      const sidebar = document.getElementById('sidebar');
      const backdrop = document.getElementById('backdrop');

      if (mobileSideTrigger && sidebar && backdrop) {
        mobileSideTrigger.addEventListener('click', (e) => {
          e.stopPropagation();
          const isExpanded = mobileSideTrigger.getAttribute('aria-expanded') === 'true';
          mobileSideTrigger.setAttribute('aria-expanded', String(!isExpanded));
          sidebar.classList.toggle('open');
          backdrop.hidden = isExpanded;
          if (!sidebar.classList.contains('open')) closeDropdown();
        });

        backdrop.addEventListener('click', () => {
          mobileSideTrigger.setAttribute('aria-expanded', 'false');
          sidebar.classList.remove('open');
          backdrop.hidden = true;
          closeDropdown();
        });
      }

      const sideToggle = document.getElementById('sideToggle');
      if (sideToggle && sidebar) {
        sideToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          const isExpanded = sideToggle.getAttribute('aria-expanded') === 'true';
          sideToggle.setAttribute('aria-expanded', String(!isExpanded));
          sidebar.setAttribute('data-state', isExpanded ? 'collapsed' : 'expanded');
          const chevronIcon = sideToggle.querySelector('iconify-icon');
          if (chevronIcon) {
            chevronIcon.setAttribute('icon', isExpanded ? 'mdi:chevron-double-right' : 'mdi:chevron-double-left');
          }
          if (isExpanded) closeDropdown();
        });
      }

      // Balance visibility sync
      const toggleBalance = document.getElementById('toggleBalance');
      const cardBalanceToggle = document.getElementById('cardBalanceToggle');
      const cardBalanceToggleDemo = document.getElementById('cardBalanceToggleDemo');
      const topBalance = document.getElementById('topBalance');
      const topEye = document.getElementById('topEye');
      const cardEye = document.getElementById('cardEye');
      const cardEyeDemo = document.getElementById('cardEyeDemo');
      let balanceHidden = false;

      function setBalanceVisibility(hidden) {
        balanceHidden = hidden;

        if (hidden) {
          if (topBalance) topBalance.textContent = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
          document.querySelectorAll('.big-amount').forEach(el => {
            el.innerHTML = '<span style="font-size:21px">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>.‚Ä¢‚Ä¢ <span>USD</span>';
          });
        } else {
          if (topBalance) topBalance.textContent = '$ 15 400.00';
          const cards = document.querySelectorAll('.account-card');
          cards.forEach(card => {
            const type = card.getAttribute('data-account-type');
            const el = card.querySelector('.big-amount');
            if (!el) return;
            if (type === 'live') el.innerHTML = '<span style="font-size:21px">15,400</span>.00 <span>USD</span>';
            if (type === 'demo') el.innerHTML = '<span style="font-size:21px">10,000</span>.00 <span>USD</span>';
          });
        }

        if (topEye) topEye.setAttribute('icon', hidden ? 'mdi:eye-off-outline' : 'mdi:eye-outline');
        if (cardEye) cardEye.setAttribute('icon', hidden ? 'mdi:eye-off-outline' : 'mdi:eye-outline');
        if (cardEyeDemo) cardEyeDemo.setAttribute('icon', hidden ? 'mdi:eye-off-outline' : 'mdi:eye-outline');
      }

      if (toggleBalance) {
        toggleBalance.addEventListener('click', (e) => {
          e.stopPropagation();
          setBalanceVisibility(!balanceHidden);
        });
      }

      if (cardBalanceToggle) {
        cardBalanceToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          setBalanceVisibility(!balanceHidden);
        });
      }

      if (cardBalanceToggleDemo) {
        cardBalanceToggleDemo.addEventListener('click', (e) => {
          e.stopPropagation();
          setBalanceVisibility(!balanceHidden);
        });
      }

      const languageBtn = document.getElementById('languageBtn');
      const languageDropdown = document.getElementById('languageDropdown');

      function toggleLanguageDropdown() {
        if (!languageDropdown) return;
        languageDropdown.hidden = !languageDropdown.hidden;
      }

      if (languageBtn && languageDropdown) {
        languageBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          toggleLanguageDropdown();
        });

        languageDropdown.addEventListener('click', (e) => {
          e.stopPropagation();
        });

        const langOptions = languageDropdown.querySelectorAll('.lang-option');
        langOptions.forEach(option => {
          option.addEventListener('click', () => {
            const lang = option.getAttribute('data-lang');
            if (!translations[lang]) return;
            currentLang = lang;

            const url = new URL(window.location.href);
            url.searchParams.set('lang', currentLang);
            window.history.replaceState({}, '', url.pathname + '?' + url.searchParams.toString());

            applyLanguage(currentLang);
            languageDropdown.hidden = true;
          });
        });

        document.addEventListener('click', () => {
          languageDropdown.hidden = true;
        });
      }

      document.addEventListener('click', () => {
        closeDropdown();
      });

      const addAccountBtn = document.querySelector('.add-account-btn');
      const addAccountOverlay = document.getElementById('addAccountOverlay');
      const addAccountForm = document.getElementById('addAccountForm');
      const addAccountCancelBtn = document.getElementById('addAccountCancelBtn');
      const addAccountCloseBtn = document.getElementById('addAccountCloseBtn');
      const addAccountSaveBtn = document.getElementById('addAccountSaveBtn');
      const addAccountToast = document.getElementById('addAccountToast');

      const accountNameInput = document.getElementById('accountName');
      const brokerInput = document.getElementById('brokerInput');
      const brokerToggle = document.getElementById('brokerToggle');
      const brokerOptions = document.getElementById('brokerOptions');
      const accountLoginInput = document.getElementById('accountLogin');
      const apiTokenInput = document.getElementById('apiToken');

      function clearErrors() {
        addAccountForm.querySelectorAll('.error-message').forEach(msg => {
          msg.style.display = 'none';
        });
      }

      function showError(fieldKey, message) {
        const group = addAccountForm.querySelector(`.input-group[data-field="${fieldKey}"]`);
        if (!group) return;
        const msg = group.querySelector('.error-message');
        if (msg) {
          msg.textContent = message;
          msg.style.display = 'block';
        }
      }

      function openAddAccountModal() {
        if (!addAccountOverlay) return;
        addAccountOverlay.classList.add('open');
        addAccountOverlay.setAttribute('aria-hidden', 'false');
        clearErrors();
        accountNameInput.focus();
      }

      function closeAddAccountModal() {
        if (!addAccountOverlay) return;
        addAccountOverlay.classList.remove('open');
        addAccountOverlay.setAttribute('aria-hidden', 'true');
        addAccountForm.reset();
        clearErrors();
        closeBrokerOptions();
      }

      function showToast() {
        if (!addAccountToast) return;
        addAccountToast.classList.add('show');
        setTimeout(() => {
          addAccountToast.classList.remove('show');
        }, 2500);
      }

      if (addAccountBtn && addAccountOverlay) {
        addAccountBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          openAddAccountModal();
        });
      }

      if (addAccountCancelBtn) {
        addAccountCancelBtn.addEventListener('click', (e) => {
          e.preventDefault();
          closeAddAccountModal();
        });
      }

      if (addAccountCloseBtn) {
        addAccountCloseBtn.addEventListener('click', (e) => {
          e.preventDefault();
          closeAddAccountModal();
        });
      }

      if (addAccountOverlay) {
        addAccountOverlay.addEventListener('click', (e) => {
          if (e.target === addAccountOverlay) {
            closeAddAccountModal();
          }
        });
      }

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && addAccountOverlay && addAccountOverlay.classList.contains('open')) {
          closeAddAccountModal();
        }
      });

      const brokers = ['Deriv'];

      function closeBrokerOptions() {
        if (!brokerOptions) return;
        brokerOptions.classList.remove('open');
      }

      function attachBrokerOptionHandlers() {
        if (!brokerOptions) return;
        const optionEls = brokerOptions.querySelectorAll('.broker-option');
        optionEls.forEach(btn => {
          if (btn.classList.contains('broker-option-empty')) return;
          btn.addEventListener('click', () => {
            const val = btn.getAttribute('data-broker') || btn.textContent.trim();
            brokerInput.value = val;
            closeBrokerOptions();
            clearErrors();
          });
        });
      }

      function renderBrokerOptions(filterText = '') {
        if (!brokerOptions) return;
        const f = filterText.toLowerCase();
        const filtered = brokers.filter(b => b.toLowerCase().includes(f));
        if (!filtered.length) {
          brokerOptions.innerHTML = '<div class="broker-option broker-option-empty">No brokers found</div>';
          brokerOptions.classList.add('open');
          return;
        }
        brokerOptions.innerHTML = filtered
          .map(b => `<button type="button" class="broker-option" data-broker="${b}">${b}</button>`)
          .join('');
        brokerOptions.classList.add('open');
        attachBrokerOptionHandlers();
      }

      function openBrokerOptions() {
        if (!brokerOptions) return;
        brokerOptions.classList.add('open');
      }

      if (brokerInput && brokerOptions) {
        renderBrokerOptions('');
        brokerInput.addEventListener('focus', () => {
          renderBrokerOptions(brokerInput.value.trim());
          openBrokerOptions();
        });
        brokerInput.addEventListener('input', () => {
          renderBrokerOptions(brokerInput.value.trim());
        });
      }

      if (brokerToggle && brokerOptions) {
        brokerToggle.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          if (brokerOptions.classList.contains('open')) {
            closeBrokerOptions();
          } else {
            renderBrokerOptions(brokerInput.value.trim());
          }
        });
      }

      if (brokerOptions) {
        brokerOptions.addEventListener('click', (e) => {
          e.stopPropagation();
        });
      }

      document.addEventListener('click', (e) => {
        if (!brokerOptions) return;
        if (
          brokerOptions.contains(e.target) ||
          e.target === brokerInput ||
          e.target === brokerToggle
        ) {
          return;
        }
        closeBrokerOptions();
      });

      if (addAccountForm && addAccountSaveBtn) {
        addAccountForm.addEventListener('submit', (e) => {
          e.preventDefault();
          clearErrors();

          const nameVal = accountNameInput.value.trim();
          const brokerVal = brokerInput.value.trim();
          const loginVal = accountLoginInput.value.trim();
          const tokenVal = apiTokenInput.value.trim();

          let valid = true;
          if (!nameVal) {
            showError('name', 'Please enter an account name.');
            valid = false;
          }
          if (!brokerVal) {
            showError('broker', 'Please select a broker.');
            valid = false;
          }
          if (!loginVal) {
            showError('login', 'Please enter your login ID.');
            valid = false;
          }
          if (!tokenVal) {
            showError('token', 'Please enter your API token.');
            valid = false;
          }

          if (!valid) return;

          addAccountSaveBtn.disabled = true;
          const originalText = addAccountSaveBtn.textContent;
          addAccountSaveBtn.textContent = 'Saving‚Ä¶';

          setTimeout(() => {
            addAccountSaveBtn.disabled = false;
            addAccountSaveBtn.textContent = originalText;
            closeAddAccountModal();
            showToast();
          }, 1500);
        });
      }

      applyLanguage(currentLang);
    });

    // ===== CHAT WIDGET LOGIC (with preview assistant response) =====
    document.addEventListener('DOMContentLoaded', function () {
      const chatFab   = document.getElementById('chatFab');
      const chatPanel = document.getElementById('chatPanel');
      const chatClose = document.getElementById('chatClose');
      const chatForm  = document.getElementById('chatForm');
      const chatInput = document.getElementById('chatInput');
      const chatBody  = document.getElementById('chatBody');

      if (!chatFab || !chatPanel) return;

      function openChat() {
        chatPanel.classList.add('open');
        chatPanel.setAttribute('aria-hidden', 'false');
        if (chatInput) {
          setTimeout(() => chatInput.focus(), 80);
        }
      }

      function closeChat() {
        chatPanel.classList.remove('open');
        chatPanel.setAttribute('aria-hidden', 'true');
      }

      chatFab.addEventListener('click', function (e) {
        e.stopPropagation();
        if (chatPanel.classList.contains('open')) {
          closeChat();
        } else {
          openChat();
        }
      });

      chatPanel.addEventListener('click', function (e) {
        e.stopPropagation();
      });

      if (chatClose) {
        chatClose.addEventListener('click', function (e) {
          e.stopPropagation();
          closeChat();
        });
      }

      // Close when tapping anywhere outside chat
      document.addEventListener('click', function (e) {
        if (!chatPanel.classList.contains('open')) return;
        const onFab = chatFab.contains(e.target);
        const insidePanel = chatPanel.contains(e.target);
        if (!onFab && !insidePanel) {
          closeChat();
        }
      });

      // ESC key closes
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
          closeChat();
        }
      });

      function appendMsg(text, role) {
        if (!chatBody) return;
        const div = document.createElement('div');
        div.className = 'chat-msg ' + (role === 'user' ? 'user' : 'bot');
        div.textContent = text;
        chatBody.appendChild(div);
        chatBody.scrollTop = chatBody.scrollHeight;
      }

      if (chatForm && chatInput) {
        chatForm.addEventListener('submit', function (e) {
          e.preventDefault();
          const msg = chatInput.value.trim();
          if (!msg) return;
          appendMsg(msg, 'user');
          chatInput.value = '';

          setTimeout(() => {
            appendMsg("This is a preview assistant on the accounts page. Your real AI trading assistant will be wired here later.", 'bot');
          }, 400);
        });
      }
    });
  </script>
</body>
</html>